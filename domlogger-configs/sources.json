{
  "config": {
    "*": {
      "!match": [
        "metamask",
        "wappalyzer",
        "google_tag_manager",
        "bitwarden",
        "messenger_awaiter",
        "grecaptcha",
        "untrustedTypes"
      ]
    },
    "String.prototype.split": {
      "match": ["\\[&\\]"]
    },
    "String.prototype.substring|String.prototype.slice": {
      "match": [
        "exec:return thisArg.startsWith('?') || thisArg.startsWith('#') || thisArg == '' ? /\\[1\\]/ : null"
      ]
    }
  },
  "hooks": {
    "CrossWindow": {
      "attribute": ["get:window.name"],
      "class": ["BroadcastChannel", "MessageEvent", "MessagePort"],
      "event": ["message"],
      "function": ["window.postMessage", "window.open"]
    },
    "NAVIGATION": {
      "event": ["hashchange", "beforeunload"],
      "function": [
        "history.pushState",
        "history.replaceState",
        "navigation.navigate"
      ]
    },
    "ParamParsing": {
      "function": [
        "String.prototype.slice",
        "String.prototype.substring",
        "String.prototype.split"
      ]
    },
    "QueryParams": {
      "attribute": [
        "get:URL.prototype.hash",
        "get:URL.prototype.search",
        "get:URL.prototype.searchParams",
        "get:URLSearchParams.prototype.get",
        "get:URLSearchParams.prototype.has"
      ],
      "class": ["URLSearchParams"]
    },
    "REQ": {
      "class": ["WebSocket", "EventSource"],
      "function": [
        "fetch",
        "navigator.sendBeacon",
        "XMLHttpRequest.prototype.send",
        "XMLHttpRequest.prototype.open"
      ]
    },
    "WebWorker": {
      "class": ["Worker", "ServiceWorker", "ServiceWorkerContainer"],
      "function": [
        "Worker.prototype.postMessage",
        "ServiceWorker.prototype.postMessage",
        "Worker.prototype.addEventListener",
        "ServiceWorker.prototype.addEventListener",
        "ServiceWorkerContainer.prototype.register"
      ]
    },
    "clipboard": {
      "event": ["copy", "cut", "paste", "beforepaste", "drag", "drop"]
    },
    "storage": {
      "attribute": ["get:document.cookie"],
      "class": ["Blob"],
      "function": ["localStorage.getItem", "sessionStorage.getItem"]
    }
  },
  "removeHeaders": ["content-security-policy"]
}
